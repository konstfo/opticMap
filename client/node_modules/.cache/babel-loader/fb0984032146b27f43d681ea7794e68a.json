{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\asus\\\\Documents\\\\javascript_studying\\\\opticMap\\\\optic-map\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\asus\\\\Documents\\\\javascript_studying\\\\opticMap\\\\optic-map\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\asus\\\\Documents\\\\javascript_studying\\\\opticMap\\\\optic-map\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\asus\\\\Documents\\\\javascript_studying\\\\opticMap\\\\optic-map\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\asus\\\\Documents\\\\javascript_studying\\\\opticMap\\\\optic-map\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\asus\\\\Documents\\\\javascript_studying\\\\opticMap\\\\optic-map\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{Map,View}from\"ol\";// import getPixelFromCoordinate from \"ol/Map\";\nimport TileLayer from\"ol/layer/Tile\";import OSM from\"ol/source/OSM\";import{fromLonLat,transformExtent,transform}from\"ol/proj\";import\"./OpticMap.css\";import{Stroke,Style,Icon}from\"ol/style\";import Feature from\"ol/Feature\";import Point from\"ol/geom/Point\";import{Control,defaults}from\"ol/control\";import VectorLayer from\"ol/layer/Vector\";import VectorSource from\"ol/source/Vector\";import LineString from\"ol/geom/LineString\";// import switchesArray from \"./res/switches.json\";\n// import opticsArray from \"./res/optics.json\";\n// import clientStationsArray from \"./res/clientStations.json\";\nimport clientStationIcon from\"./img/client_station_icon.png\";import switchIcon from\"./img/switch_icon.png\";var OpticMap=/*#__PURE__*/function(_Component){_inherits(OpticMap,_Component);function OpticMap(props){var _this;_classCallCheck(this,OpticMap);_this=_possibleConstructorReturn(this,_getPrototypeOf(OpticMap).call(this,props));_this.handleEditSubmit=function(evt){evt.preventDefault();var editedItem={address:_this.refs.addressFormField.value,locationInfo:_this.refs.locationInfoFormField.value,ipAddress:_this.refs.ipAddressFormField.value,info:_this.refs.infoFormField.value,coordinates:_this.refs.coordinateFormField.value.split(\",\")};var itemToEdit={address:_this.state.featureInfo.address,locationInfo:_this.state.featureInfo.locationInfo,ipAddress:_this.state.featureInfo.ipAddress,info:_this.state.featureInfo.info,coordinates:_this.state.featureInfo.featureCoordinates};_this.setState({currentForm:null});function transformCoordinates(coordinates){var opticsCoordinates=[];// let formCoordinatesArray = coordinates.split(\",\");\nvar arrayLenght=coordinates.length;var i=0;while(i<arrayLenght){opticsCoordinates.push(new Array(coordinates[i],coordinates[i+1]));i++;i++;}return opticsCoordinates;}if(!Array.isArray(editedItem.coordinates[0])&&!Array.isArray(itemToEdit.coordinates[0])){_this.editSwitchInfo(itemToEdit,editedItem);_this.editClientStationInfo(itemToEdit,editedItem);}else{_this.editOptics({address:_this.state.featureInfo.address,locationInfo:_this.state.featureInfo.locationInfo,ipAddress:_this.state.featureInfo.ipAddress,info:_this.state.featureInfo.info,coordinates:transformCoordinates(_this.state.featureInfo.featureCoordinates)},{address:_this.refs.addressFormField.value,locationInfo:_this.refs.locationInfoFormField.value,ipAddress:_this.refs.ipAddressFormField.value,info:_this.refs.infoFormField.value,coordinates:transformCoordinates(_this.refs.coordinateFormField.value.split(\",\"))});}_this.setState({displayedFeatures:null,featureInfo:{featureCoordinates:null,address:null,ipAddress:null,info:null,locationInfo:null}});};_this.handleDeleteButton=function(evt){evt.preventDefault();var itemToDelete={address:_this.refs.addressFormField.value,locationInfo:_this.refs.locationInfoFormField.value,ipAddress:_this.refs.ipAddressFormField.value,info:_this.refs.infoFormField.value,coordinates:_this.refs.coordinateFormField.value.split(\",\")};var opticsCoordinates=[];var formCoordinatesArray=_this.refs.coordinateFormField.value.split(\",\");var arrayLenght=formCoordinatesArray.length;var i=0;while(i<arrayLenght){opticsCoordinates.push(new Array(formCoordinatesArray[i],formCoordinatesArray[i+1]));i++;i++;}_this.deleteSwitch(itemToDelete);_this.deleteClientStation(itemToDelete);_this.deleteOptics({address:_this.refs.addressFormField.value,locationInfo:_this.refs.locationInfoFormField.value,ipAddress:_this.refs.ipAddressFormField.value,info:_this.refs.infoFormField.value,coordinates:opticsCoordinates});_this.setState({displayedFeatures:null,featureInfo:{featureCoordinates:null,address:null,ipAddress:null,info:null,locationInfo:null}});};_this.handleAddSubmit=function(evt){evt.preventDefault();var itemType=_this.state.formItemType;switch(itemType){case\"switch\":var switchCoordinatesFromForm=_this.refs.coordinateFormField.value.split(\",\");if(!Array.isArray(switchCoordinatesFromForm[0])){_this.addNewSwitch({address:_this.refs.addressFormField.value,locationInfo:_this.refs.locationInfoFormField.value,ipAddress:_this.refs.ipAddressFormField.value,info:_this.refs.infoFormField.value,coordinates:_this.refs.coordinateFormField.value.split(\",\")});}else{console.log(\"Wrong coordinates for switch.\");}break;case\"clientStation\":var clientStationCoordinatesFromForm=_this.refs.coordinateFormField.value.split(\",\");if(!Array.isArray(clientStationCoordinatesFromForm[0])){_this.addNewClientStation({address:_this.refs.addressFormField.value,locationInfo:_this.refs.locationInfoFormField.value,ipAddress:_this.refs.ipAddressFormField.value,info:_this.refs.infoFormField.value,coordinates:_this.refs.coordinateFormField.value.split(\",\")});}else{console.log(\"Wrong coordinates for client station.\");}break;case\"opticCable\":var opticsCoordinates=[];var formCoordinatesArray=_this.refs.coordinateFormField.value.split(\",\");var arrayLenght=formCoordinatesArray.length;if(arrayLenght%2!==0||arrayLenght===0){console.log(\"Wrong optics coordinates.\");}else{if(arrayLenght<=2){console.log(\"need more points.\");}else{var i=0;while(i<arrayLenght){opticsCoordinates.push(new Array(formCoordinatesArray[i],formCoordinatesArray[i+1]));i++;i++;}_this.addOptics({address:_this.refs.addressFormField.value,locationInfo:_this.refs.locationInfoFormField.value,ipAddress:_this.refs.ipAddressFormField.value,info:_this.refs.infoFormField.value,coordinates:opticsCoordinates});}}break;default:console.log(\"Default case\");}_this.setState({currentForm:null});};_this.state={map:null,coordinates:\"coordinates\",currentForm:null,formItemType:null,displayedFeatures:null,featureInfo:{featureCoordinates:null,address:null,ipAddress:null,info:null,locationInfo:null},switchesContainerArray:null,opticsContainerArray:null,clientStationsContainerArray:null};_this.addButton=_this.handleAddButton.bind(_assertThisInitialized(_this));_this.handleEditSubmit=_this.handleEditSubmit.bind(_assertThisInitialized(_this));_this.handleAddSubmit=_this.handleAddSubmit.bind(_assertThisInitialized(_this));_this.handleZoom=_this.handleZoom.bind(_assertThisInitialized(_this));_this.setSwitchesToRightControlPanel=_this.setSwitchesToRightControlPanel.bind(_assertThisInitialized(_this));_this.setOpticsToRightControlPanel=_this.setOpticsToRightControlPanel.bind(_assertThisInitialized(_this));_this.setClientStationsToRightControlPanel=_this.setClientStationsToRightControlPanel.bind(_assertThisInitialized(_this));_this.initMapComponent=_this.initMapComponent.bind(_assertThisInitialized(_this));_this.changeFeaturesSize=_this.changeFeaturesSize.bind(_assertThisInitialized(_this));_this.getFeatureInfo=_this.getFeatureInfo.bind(_assertThisInitialized(_this));_this.getfeatureInfoBlock=_this.getfeatureInfoBlock.bind(_assertThisInitialized(_this));_this.getEditingOrAddingForm=_this.getEditingOrAddingForm.bind(_assertThisInitialized(_this));_this.addNewSwitch=_this.addNewSwitch.bind(_assertThisInitialized(_this));_this.deleteSwitch=_this.deleteSwitch.bind(_assertThisInitialized(_this));_this.editSwitchInfo=_this.editSwitchInfo.bind(_assertThisInitialized(_this));_this.addOptics=_this.addOptics.bind(_assertThisInitialized(_this));_this.deleteOptics=_this.deleteOptics.bind(_assertThisInitialized(_this));_this.editOptics=_this.editOptics.bind(_assertThisInitialized(_this));_this.addNewClientStation=_this.addNewClientStation.bind(_assertThisInitialized(_this));_this.deleteClientStation=_this.deleteClientStation.bind(_assertThisInitialized(_this));_this.editClientStationInfo=_this.editClientStationInfo.bind(_assertThisInitialized(_this));return _this;}//\n//switch control methods\n_createClass(OpticMap,[{key:\"addNewSwitch\",value:function addNewSwitch(data){var _this2=this;var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)};fetch(\"/api/addSwitch\",options).then(function(){_this2.initMapComponent();});}},{key:\"editSwitchInfo\",value:function editSwitchInfo(itemToReplace,newItem){var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify([itemToReplace,newItem])};fetch(\"/api/editSwitch\",options);}},{key:\"deleteSwitch\",value:function deleteSwitch(data){var _this3=this;var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)};fetch(\"/api/deleteSwitch\",options).then(function(){_this3.initMapComponent();});}//\n//\n//\n//client stations control methods\n},{key:\"addNewClientStation\",value:function addNewClientStation(data){var _this4=this;var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)};fetch(\"/api/addClientStation\",options).then(function(){_this4.initMapComponent();});}},{key:\"editClientStationInfo\",value:function editClientStationInfo(itemToReplace,newItem){var _this5=this;var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify([itemToReplace,newItem])};fetch(\"/api/editClientStation\",options).then(function(){_this5.initMapComponent();});}},{key:\"deleteClientStation\",value:function deleteClientStation(data){var _this6=this;var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)};fetch(\"/api/deleteClientStation\",options).then(function(){_this6.initMapComponent();});}//\n//\n//\n//optic cable control methods\n},{key:\"addOptics\",value:function addOptics(data){var _this7=this;var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)};fetch(\"/api/addOptics\",options).then(function(){_this7.initMapComponent();});}},{key:\"editOptics\",value:function editOptics(itemToReplace,newItem){var _this8=this;var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify([itemToReplace,newItem])};fetch(\"/api/editOptics\",options).then(function(){_this8.initMapComponent();});}},{key:\"deleteOptics\",value:function deleteOptics(data){var _this9=this;var options={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)};fetch(\"/api/deleteOptics\",options).then(function(){_this9.initMapComponent();});}//\n//\n},{key:\"initMapComponent\",value:function initMapComponent(){var _this10=this;var switchFeatureArray=[];var opticsFeatureArray=[];var clientStationsFeatureArray=[];//get switches from server\nfetch(\"/api/switches\").then(function(res){return res.json();}).then(function(switches){switches.map(function(data){var featureElement=new Feature({geometry:new Point(fromLonLat(data.coordinates)),featureType:\"switch\",address:data.address,ipAddress:data.ipAddress,info:data.info,locationInfo:data.locationInfo,featureCoordinates:data.coordinates});switchesLayerSource.addFeature(featureElement);switchFeatureArray.push(featureElement);_this10.setState({switchesContainerArray:switchFeatureArray});});});//get optics from server\nfetch(\"/api/optics\").then(function(res){return res.json();}).then(function(optics){return optics.map(function(data){var coordinatesArray=[];data.coordinates.map(function(coordinate){coordinatesArray.push(fromLonLat(coordinate));});var featureElement=new Feature({geometry:new LineString(coordinatesArray),featureType:\"optics\",address:data.address,ipAddress:data.ipAddress,info:data.info,locationInfo:data.locationInfo,featureCoordinates:data.coordinates});opticsLayerSource.addFeature(featureElement);opticsFeatureArray.push(featureElement);_this10.setState({opticsContainerArray:opticsFeatureArray});});});fetch(\"/api/clientStations\").then(function(res){return res.json();}).then(function(clientStations){clientStations.map(function(data){var featureElement=new Feature({geometry:new Point(fromLonLat(data.coordinates)),featureType:\"clientStation\",address:data.address,ipAddress:data.ipAddress,info:data.info,locationInfo:data.locationInfo,featureCoordinates:data.coordinates});clientStationsLayerSource.addFeature(featureElement);clientStationsFeatureArray.push(featureElement);_this10.setState({clientStationsContainerArray:clientStationsFeatureArray});});});var extentView=transformExtent([20.969893/** min x */,57.540673/** min y */,28.413477/** max x */,59.894102/** max y */],\"EPSG:4326\",\"EPSG:3857\");var extentLayer=transformExtent([16.581885/** min x */,55.671002/** min y */,32.794556/** max x */,61.543774/** max y */],\"EPSG:4326\",\"EPSG:3857\");var layerVisibilityControl=function(Control){function layerVisibilityControl(layerName,className,buttontext){var button=document.createElement(\"button\");button.innerHTML=buttontext;var element=document.createElement(\"div\");element.className=className+\" ol-unselectable ol-control\";element.appendChild(button);Control.call(this,{element:element});button.addEventListener(\"click\",this.handlelayerVisibilityControl.bind(this,layerName),false);}if(Control)layerVisibilityControl.__proto__=Control;layerVisibilityControl.prototype=Object.create(Control&&Control.prototype);layerVisibilityControl.prototype.constructor=layerVisibilityControl;layerVisibilityControl.prototype.handlelayerVisibilityControl=function handlelayerVisibilityControl(layerName){map.getLayers().getArray().map(function(layer){if(layer.getClassName()===layerName){layer.setVisible(!layer.getVisible());}});};return layerVisibilityControl;}(Control);var map=new Map({target:this.refs.mapContainer,layers:[new TileLayer({source:new OSM(),extent:extentLayer,zIndex:0})],view:new View({center:fromLonLat([28.185281,59.374348]),zoom:14,extent:extentView,minZoom:7.5}),controls:defaults({attributionOptions:{target:this.refs.mapContainer}}).extend([new layerVisibilityControl(\"switchesLayer\",\"switches-visible\",\"switches\"),new layerVisibilityControl(\"opticsLayer\",\"optics-visible\",\"optic cables\"),new layerVisibilityControl(\"clientStationsLayer\",\"clientStations-visible\",\"client stations\")])});var opticsLayerSource=new VectorSource({features:opticsFeatureArray});this.opticsLayer=new VectorLayer({className:\"opticsLayer\",source:opticsLayerSource,visible:true,style:new Style({stroke:new Stroke({width:2,color:\"skyblue\"})})});var clientStationsLayerSource=new VectorSource({features:clientStationsFeatureArray});this.clientStationsLayer=new VectorLayer({className:\"clientStationsLayer\",source:clientStationsLayerSource,visible:true,style:new Style({image:new Icon({opacity:1,src:clientStationIcon,scale:0.09})})});var switchesLayerSource=new VectorSource({features:switchFeatureArray});this.switchesLayer=new VectorLayer({className:\"switchesLayer\",source:switchesLayerSource,visible:true,style:new Style({image:new Icon({opacity:1,src:switchIcon,scale:0.09})})});//layers with network equipment\n//map feature settings\n//layers settings\nmap.addLayer(this.clientStationsLayer);map.addLayer(this.switchesLayer);map.addLayer(this.opticsLayer);//layers settings\n//click on map\nmap.on(\"click\",function(pointOfClick){var clickedCoordinate=transform(pointOfClick.coordinate,\"EPSG:3857\",\"EPSG:4326\");var coordinateString=clickedCoordinate[0].toFixed(6)+\",\"+clickedCoordinate[1].toFixed(6);this.setState({coordinates:coordinateString,featureCoordinates:coordinateString});map.forEachFeatureAtPixel(pointOfClick.pixel,function(feature){this.setState({featureInfo:{featureCoordinates:feature.getProperties().featureCoordinates,address:feature.getProperties().address,ipAddress:feature.getProperties().ipAddress,info:feature.getProperties().info,locationInfo:feature.getProperties().locationInfo,featureContainerArray:feature.getProperties().featureContainerArray}});this.state.map.getView().animate({center:fromLonLat(clickedCoordinate)},{zoom:19});}.bind(this));}.bind(this));// change features size on zoom change\nmap.getView().on(\"propertychange\",function(e){// switch (e.key) {\n//   case \"resolution\":\n//     this.handleZoom(map.getView().getZoom());\n//     break;\n// }\nif(e.key===\"resolution\"){_this10.handleZoom(map.getView().getZoom());}});this.setState({map:map});}},{key:\"componentDidMount\",value:function componentDidMount(){this.initMapComponent();}},{key:\"setSwitchesToRightControlPanel\",value:function setSwitchesToRightControlPanel(){this.setState({displayedFeatures:this.state.switchesContainerArray});}},{key:\"setOpticsToRightControlPanel\",value:function setOpticsToRightControlPanel(){this.setState({displayedFeatures:this.state.opticsContainerArray});}},{key:\"setClientStationsToRightControlPanel\",value:function setClientStationsToRightControlPanel(){this.setState({displayedFeatures:this.state.clientStationsContainerArray});}},{key:\"handleRightPanelItemClick\",value:function handleRightPanelItemClick(item){if(this.state.currentForm!=null){this.setState({currentForm:null,formItemType:null});}var coordinatesForAnimation;var featureCoordinates=item.getProperties().featureCoordinates;if(Array.isArray(featureCoordinates[0])){coordinatesForAnimation=featureCoordinates[0];}else{coordinatesForAnimation=featureCoordinates;}this.state.map.getView().animate({center:fromLonLat(coordinatesForAnimation)},{zoom:18.5});this.setState({featureInfo:{featureCoordinates:item.getProperties().featureCoordinates,address:item.getProperties().address,ipAddress:item.getProperties().ipAddress,info:item.getProperties().info,locationInfo:item.getProperties().locationInfo}});}},{key:\"changeFeaturesSize\",value:function changeFeaturesSize(strokeWidth,iconsScale){this.switchesLayer.setStyle(new Style({image:new Icon({opacity:1,src:switchIcon,scale:iconsScale})}));this.opticsLayer.setStyle(new Style({stroke:new Stroke({width:strokeWidth,color:\"skyblue\"})}));this.clientStationsLayer.setStyle(new Style({image:new Icon({opacity:1,src:clientStationIcon,scale:iconsScale})}));}},{key:\"handleZoom\",value:function handleZoom(zoomSize){if(zoomSize<12){this.changeFeaturesSize(0.5,0.01);}else if(zoomSize<13){this.changeFeaturesSize(2,0.05);}else if(zoomSize<14){this.changeFeaturesSize(2,0.08);}else if(zoomSize<16){this.changeFeaturesSize(2,0.1);}else if(zoomSize<18){this.changeFeaturesSize(4,0.12);}else{this.changeFeaturesSize(7,0.25);}}},{key:\"getFeatureInfo\",value:function getFeatureInfo(featureInfo){return featureInfo!==null?React.createElement(\"div\",{className:\"featureInfoElement\"},featureInfo):React.createElement(\"div\",{className:\"hidden\"});}},{key:\"getfeatureInfoBlock\",value:function getfeatureInfoBlock(){var _this11=this;if(this.state.featureInfo.featureCoordinates!==null){return React.createElement(\"div\",{className:\"featureInfo\"},this.getFeatureInfo(this.state.featureInfo.address),this.getFeatureInfo(this.state.featureInfo.ipAddress),this.getFeatureInfo(this.state.featureInfo.info),this.getFeatureInfo(this.state.featureInfo.locationInfo),React.createElement(\"div\",{className:\"editButton\",onClick:function onClick(){_this11.setState({currentForm:null});_this11.setState({currentForm:\"edit\"});}},\"Edit\"));}else{return React.createElement(\"div\",{className:\"hidden\"});}}},{key:\"handleAddButton\",value:function handleAddButton(itemType){this.setState({formItemType:itemType});}},{key:\"getEditingOrAddingForm\",value:function getEditingOrAddingForm(itemType){var _this12=this;if(this.state.currentForm===\"add\"){return React.createElement(\"div\",{className:\"formContainer\"},React.createElement(\"form\",{className:\"addForm\",onSubmit:function onSubmit(evt){return _this12.handleAddSubmit(evt,itemType);}},React.createElement(\"textarea\",{className:\"formField\",ref:\"coordinateFormField\",placeholder:\"coordinates\",defaultValue:this.state.featureCoordinates}),React.createElement(\"textarea\",{className:\"formField\",ref:\"addressFormField\",placeholder:\"address\",defaultValue:\"\"}),React.createElement(\"textarea\",{className:\"formField\",ref:\"ipAddressFormField\",placeholder:\"ip address\",defaultValue:\"\"}),React.createElement(\"textarea\",{className:\"formField\",ref:\"locationInfoFormField\",placeholder:\"location info\",defaultValue:\"\"}),React.createElement(\"textarea\",{className:\"formField\",ref:\"infoFormField\",placeholder:\"additional info\",defaultValue:\"\"}),React.createElement(\"div\",{className:\"formButtonsContainer\"},React.createElement(\"button\",{type:\"submit\"},\"Submit\"),React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return _this12.setState({currentForm:null});}},\"Cancel\"))));}else if(this.state.currentForm===\"edit\"){return React.createElement(\"div\",{className:\"formContainer\"},React.createElement(\"form\",{className:\"editForm\",onSubmit:function onSubmit(evt){return _this12.handleEditSubmit(evt);}},React.createElement(\"textarea\",{className:\"formField\",ref:\"coordinateFormField\",defaultValue:this.state.featureInfo.featureCoordinates,style:{backgroundColor:\"lightgray\"},readOnly:true}),React.createElement(\"textarea\",{className:\"formField\",ref:\"addressFormField\",placeholder:\"address\",defaultValue:this.state.featureInfo.address}),React.createElement(\"textarea\",{className:\"formField\",ref:\"ipAddressFormField\",placeholder:\"ip address\",defaultValue:this.state.featureInfo.ipAddress}),React.createElement(\"textarea\",{className:\"formField\",ref:\"locationInfoFormField\",placeholder:\"location info\",defaultValue:this.state.featureInfo.locationInfo}),React.createElement(\"textarea\",{className:\"formField\",ref:\"infoFormField\",placeholder:\"additional info\",defaultValue:this.state.featureInfo.info}),React.createElement(\"div\",{className:\"formButtonsContainer\"},React.createElement(\"button\",{type:\"button\",onClick:function onClick(evt){_this12.handleDeleteButton(evt);_this12.setState({currentForm:null});}},\"Delete\"),React.createElement(\"button\",{type:\"submit\"},\"Submit\"),React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return _this12.setState({currentForm:null});}},\"Cancel\"))));}else{return React.createElement(\"div\",null);}}},{key:\"render\",value:function render(){var _this13=this;return React.createElement(\"div\",{className:\"opticMapComponent\"},React.createElement(\"div\",{className:\"leftMapPanel\"},React.createElement(\"div\",{className:\"coordinateString\",id:\"coordinateString\"},this.state.coordinates),React.createElement(\"div\",{className:\"objectButtons\"},React.createElement(\"div\",{className:\"featureInfoAddControls\"},React.createElement(\"div\",{className:\"objectButton\",onClick:this.setSwitchesToRightControlPanel},\"switches\"),React.createElement(\"div\",{className:\"addFeatureButton\",onClick:function onClick(){_this13.setState({currentForm:null});_this13.handleAddButton(\"switch\");_this13.setState({currentForm:\"add\"});}},\"add\")),React.createElement(\"div\",{className:\"featureInfoAddControls\"},React.createElement(\"div\",{className:\"objectButton\",onClick:this.setOpticsToRightControlPanel},\"optic cable\"),React.createElement(\"div\",{className:\"addFeatureButton\",onClick:function onClick(){_this13.setState({currentForm:null});_this13.handleAddButton(\"opticCable\");_this13.setState({currentForm:\"add\"});}},\"add\")),React.createElement(\"div\",{className:\"featureInfoAddControls\"},React.createElement(\"div\",{className:\"objectButton\",onClick:this.setClientStationsToRightControlPanel},\"client stations\"),React.createElement(\"div\",{className:\"addFeatureButton\",onClick:function onClick(){_this13.setState({currentForm:null});_this13.handleAddButton(\"clientStation\");_this13.setState({currentForm:\"add\"});}},\"add\"))),this.getfeatureInfoBlock(),this.getEditingOrAddingForm(this.state.featureInfo.featureCoordinates,this.state.featureInfo.address,this.state.featureInfo.ipAddress,this.state.featureInfo.locationInfo,this.state.featureInfo.info)),React.createElement(\"div\",{className:\"mapContainer\",ref:\"mapContainer\"}),React.createElement(\"div\",{className:\"rightMapPanel\"},React.createElement(\"div\",{className:\"displayedFeatures\"},this.state.displayedFeatures!==null?this.state.displayedFeatures.map(function(feature){return React.createElement(\"li\",{className:\"displayedFeature\",key:feature.getProperties().featureCoordinates,onClick:_this13.handleRightPanelItemClick.bind(_this13,feature)},feature.getProperties().address);}):React.createElement(\"div\",null))));}}]);return OpticMap;}(Component);export default OpticMap;","map":{"version":3,"sources":["C:/Users/asus/Documents/javascript_studying/opticMap/optic-map/src/OpticMap.js"],"names":["React","Component","Map","View","TileLayer","OSM","fromLonLat","transformExtent","transform","Stroke","Style","Icon","Feature","Point","Control","defaults","VectorLayer","VectorSource","LineString","clientStationIcon","switchIcon","OpticMap","props","handleEditSubmit","evt","preventDefault","editedItem","address","refs","addressFormField","value","locationInfo","locationInfoFormField","ipAddress","ipAddressFormField","info","infoFormField","coordinates","coordinateFormField","split","itemToEdit","state","featureInfo","featureCoordinates","setState","currentForm","transformCoordinates","opticsCoordinates","arrayLenght","length","i","push","Array","isArray","editSwitchInfo","editClientStationInfo","editOptics","displayedFeatures","handleDeleteButton","itemToDelete","formCoordinatesArray","deleteSwitch","deleteClientStation","deleteOptics","handleAddSubmit","itemType","formItemType","switchCoordinatesFromForm","addNewSwitch","console","log","clientStationCoordinatesFromForm","addNewClientStation","addOptics","map","switchesContainerArray","opticsContainerArray","clientStationsContainerArray","addButton","handleAddButton","bind","handleZoom","setSwitchesToRightControlPanel","setOpticsToRightControlPanel","setClientStationsToRightControlPanel","initMapComponent","changeFeaturesSize","getFeatureInfo","getfeatureInfoBlock","getEditingOrAddingForm","data","options","method","headers","body","JSON","stringify","fetch","then","itemToReplace","newItem","switchFeatureArray","opticsFeatureArray","clientStationsFeatureArray","res","json","switches","featureElement","geometry","featureType","switchesLayerSource","addFeature","optics","coordinatesArray","coordinate","opticsLayerSource","clientStations","clientStationsLayerSource","extentView","extentLayer","layerVisibilityControl","layerName","className","buttontext","button","document","createElement","innerHTML","element","appendChild","call","addEventListener","handlelayerVisibilityControl","__proto__","prototype","Object","create","constructor","getLayers","getArray","layer","getClassName","setVisible","getVisible","target","mapContainer","layers","source","extent","zIndex","view","center","zoom","minZoom","controls","attributionOptions","extend","features","opticsLayer","visible","style","stroke","width","color","clientStationsLayer","image","opacity","src","scale","switchesLayer","addLayer","on","pointOfClick","clickedCoordinate","coordinateString","toFixed","forEachFeatureAtPixel","pixel","feature","getProperties","featureContainerArray","getView","animate","e","key","getZoom","item","coordinatesForAnimation","strokeWidth","iconsScale","setStyle","zoomSize","backgroundColor","handleRightPanelItemClick"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Map, View } from \"ol\";\n// import getPixelFromCoordinate from \"ol/Map\";\nimport TileLayer from \"ol/layer/Tile\";\nimport OSM from \"ol/source/OSM\";\nimport { fromLonLat, transformExtent, transform } from \"ol/proj\";\nimport \"./OpticMap.css\";\nimport { Stroke, Style, Icon } from \"ol/style\";\nimport Feature from \"ol/Feature\";\nimport Point from \"ol/geom/Point\";\nimport { Control, defaults } from \"ol/control\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorSource from \"ol/source/Vector\";\nimport LineString from \"ol/geom/LineString\";\n// import switchesArray from \"./res/switches.json\";\n// import opticsArray from \"./res/optics.json\";\n// import clientStationsArray from \"./res/clientStations.json\";\n\nimport clientStationIcon from \"./img/client_station_icon.png\";\nimport switchIcon from \"./img/switch_icon.png\";\n\nclass OpticMap extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      map: null,\n      coordinates: \"coordinates\",\n      currentForm: null,\n      formItemType: null,\n      displayedFeatures: null,\n      featureInfo: {\n        featureCoordinates: null,\n        address: null,\n        ipAddress: null,\n        info: null,\n        locationInfo: null,\n      },\n      switchesContainerArray: null,\n      opticsContainerArray: null,\n      clientStationsContainerArray: null,\n    };\n\n    this.addButton = this.handleAddButton.bind(this);\n\n    this.handleEditSubmit = this.handleEditSubmit.bind(this);\n    this.handleAddSubmit = this.handleAddSubmit.bind(this);\n\n    this.handleZoom = this.handleZoom.bind(this);\n\n    this.setSwitchesToRightControlPanel = this.setSwitchesToRightControlPanel.bind(\n      this\n    );\n\n    this.setOpticsToRightControlPanel = this.setOpticsToRightControlPanel.bind(\n      this\n    );\n\n    this.setClientStationsToRightControlPanel = this.setClientStationsToRightControlPanel.bind(\n      this\n    );\n\n    this.initMapComponent = this.initMapComponent.bind(this);\n\n    this.changeFeaturesSize = this.changeFeaturesSize.bind(this);\n\n    this.getFeatureInfo = this.getFeatureInfo.bind(this);\n    this.getfeatureInfoBlock = this.getfeatureInfoBlock.bind(this);\n\n    this.getEditingOrAddingForm = this.getEditingOrAddingForm.bind(this);\n\n    this.addNewSwitch = this.addNewSwitch.bind(this);\n    this.deleteSwitch = this.deleteSwitch.bind(this);\n    this.editSwitchInfo = this.editSwitchInfo.bind(this);\n\n    this.addOptics = this.addOptics.bind(this);\n    this.deleteOptics = this.deleteOptics.bind(this);\n    this.editOptics = this.editOptics.bind(this);\n\n    this.addNewClientStation = this.addNewClientStation.bind(this);\n    this.deleteClientStation = this.deleteClientStation.bind(this);\n    this.editClientStationInfo = this.editClientStationInfo.bind(this);\n  }\n\n  //\n  //switch control methods\n  addNewSwitch(data) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n    };\n    fetch(\"/api/addSwitch\", options).then(() => {\n      this.initMapComponent();\n    });\n  }\n\n  editSwitchInfo(itemToReplace, newItem) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify([itemToReplace, newItem]),\n    };\n    fetch(\"/api/editSwitch\", options);\n  }\n\n  deleteSwitch(data) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n    };\n    fetch(\"/api/deleteSwitch\", options).then(() => {\n      this.initMapComponent();\n    });\n  }\n  //\n  //\n\n  //\n  //client stations control methods\n  addNewClientStation(data) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n    };\n    fetch(\"/api/addClientStation\", options).then(() => {\n      this.initMapComponent();\n    });\n  }\n\n  editClientStationInfo(itemToReplace, newItem) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify([itemToReplace, newItem]),\n    };\n    fetch(\"/api/editClientStation\", options).then(() => {\n      this.initMapComponent();\n    });\n  }\n\n  deleteClientStation(data) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n    };\n    fetch(\"/api/deleteClientStation\", options).then(() => {\n      this.initMapComponent();\n    });\n  }\n  //\n  //\n\n  //\n  //optic cable control methods\n  addOptics(data) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n    };\n    fetch(\"/api/addOptics\", options).then(() => {\n      this.initMapComponent();\n    });\n  }\n\n  editOptics(itemToReplace, newItem) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify([itemToReplace, newItem]),\n    };\n    fetch(\"/api/editOptics\", options).then(() => {\n      this.initMapComponent();\n    });\n  }\n\n  deleteOptics(data) {\n    let options = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n    };\n    fetch(\"/api/deleteOptics\", options).then(() => {\n      this.initMapComponent();\n    });\n  }\n  //\n  //\n\n  initMapComponent() {\n    let switchFeatureArray = [];\n    let opticsFeatureArray = [];\n    let clientStationsFeatureArray = [];\n\n    //get switches from server\n    fetch(\"/api/switches\")\n      .then((res) => res.json())\n      .then((switches) => {\n        switches.map((data) => {\n          let featureElement = new Feature({\n            geometry: new Point(fromLonLat(data.coordinates)),\n            featureType: \"switch\",\n            address: data.address,\n            ipAddress: data.ipAddress,\n            info: data.info,\n            locationInfo: data.locationInfo,\n            featureCoordinates: data.coordinates,\n          });\n          switchesLayerSource.addFeature(featureElement);\n\n          switchFeatureArray.push(featureElement);\n          this.setState({ switchesContainerArray: switchFeatureArray });\n        });\n      });\n\n    //get optics from server\n    fetch(\"/api/optics\")\n      .then((res) => res.json())\n      .then((optics) =>\n        optics.map((data) => {\n          let coordinatesArray = [];\n          data.coordinates.map((coordinate) => {\n            coordinatesArray.push(fromLonLat(coordinate));\n          });\n\n          let featureElement = new Feature({\n            geometry: new LineString(coordinatesArray),\n            featureType: \"optics\",\n            address: data.address,\n            ipAddress: data.ipAddress,\n            info: data.info,\n            locationInfo: data.locationInfo,\n            featureCoordinates: data.coordinates,\n          });\n\n          opticsLayerSource.addFeature(featureElement);\n\n          opticsFeatureArray.push(featureElement);\n          this.setState({\n            opticsContainerArray: opticsFeatureArray,\n          });\n        })\n      );\n\n    fetch(\"/api/clientStations\")\n      .then((res) => res.json())\n      .then((clientStations) => {\n        clientStations.map((data) => {\n          let featureElement = new Feature({\n            geometry: new Point(fromLonLat(data.coordinates)),\n            featureType: \"clientStation\",\n            address: data.address,\n            ipAddress: data.ipAddress,\n            info: data.info,\n            locationInfo: data.locationInfo,\n            featureCoordinates: data.coordinates,\n          });\n          clientStationsLayerSource.addFeature(featureElement);\n\n          clientStationsFeatureArray.push(featureElement);\n          this.setState({\n            clientStationsContainerArray: clientStationsFeatureArray,\n          });\n        });\n      });\n\n    const extentView = transformExtent(\n      [\n        20.969893 /** min x */,\n        57.540673 /** min y */,\n        28.413477 /** max x */,\n        59.894102 /** max y */,\n      ],\n      \"EPSG:4326\",\n      \"EPSG:3857\"\n    );\n    const extentLayer = transformExtent(\n      [\n        16.581885 /** min x */,\n        55.671002 /** min y */,\n        32.794556 /** max x */,\n        61.543774 /** max y */,\n      ],\n      \"EPSG:4326\",\n      \"EPSG:3857\"\n    );\n\n    const layerVisibilityControl = (function (Control) {\n      function layerVisibilityControl(layerName, className, buttontext) {\n        const button = document.createElement(\"button\");\n        button.innerHTML = buttontext;\n\n        var element = document.createElement(\"div\");\n        element.className = className + \" ol-unselectable ol-control\";\n        element.appendChild(button);\n\n        Control.call(this, {\n          element: element,\n        });\n\n        button.addEventListener(\n          \"click\",\n          this.handlelayerVisibilityControl.bind(this, layerName),\n          false\n        );\n      }\n\n      if (Control) layerVisibilityControl.__proto__ = Control;\n      layerVisibilityControl.prototype = Object.create(\n        Control && Control.prototype\n      );\n      layerVisibilityControl.prototype.constructor = layerVisibilityControl;\n\n      layerVisibilityControl.prototype.handlelayerVisibilityControl = function handlelayerVisibilityControl(\n        layerName\n      ) {\n        map\n          .getLayers()\n          .getArray()\n          .map((layer) => {\n            if (layer.getClassName() === layerName) {\n              layer.setVisible(!layer.getVisible());\n            }\n          });\n      };\n\n      return layerVisibilityControl;\n    })(Control);\n\n    const map = new Map({\n      target: this.refs.mapContainer,\n      layers: [\n        new TileLayer({\n          source: new OSM(),\n          extent: extentLayer,\n          zIndex: 0,\n        }),\n      ],\n      view: new View({\n        center: fromLonLat([28.185281, 59.374348]),\n        zoom: 14,\n        extent: extentView,\n        minZoom: 7.5,\n      }),\n      controls: defaults({\n        attributionOptions: {\n          target: this.refs.mapContainer,\n        },\n      }).extend([\n        new layerVisibilityControl(\n          \"switchesLayer\",\n          \"switches-visible\",\n          \"switches\"\n        ),\n        new layerVisibilityControl(\n          \"opticsLayer\",\n          \"optics-visible\",\n          \"optic cables\"\n        ),\n        new layerVisibilityControl(\n          \"clientStationsLayer\",\n          \"clientStations-visible\",\n          \"client stations\"\n        ),\n      ]),\n    });\n\n    let opticsLayerSource = new VectorSource({\n      features: opticsFeatureArray,\n    });\n\n    this.opticsLayer = new VectorLayer({\n      className: \"opticsLayer\",\n      source: opticsLayerSource,\n      visible: true,\n      style: new Style({\n        stroke: new Stroke({\n          width: 2,\n          color: \"skyblue\",\n        }),\n      }),\n    });\n\n    let clientStationsLayerSource = new VectorSource({\n      features: clientStationsFeatureArray,\n    });\n\n    this.clientStationsLayer = new VectorLayer({\n      className: \"clientStationsLayer\",\n      source: clientStationsLayerSource,\n      visible: true,\n      style: new Style({\n        image: new Icon({\n          opacity: 1,\n          src: clientStationIcon,\n          scale: 0.09,\n        }),\n      }),\n    });\n\n    let switchesLayerSource = new VectorSource({\n      features: switchFeatureArray,\n    });\n\n    this.switchesLayer = new VectorLayer({\n      className: \"switchesLayer\",\n      source: switchesLayerSource,\n      visible: true,\n      style: new Style({\n        image: new Icon({\n          opacity: 1,\n          src: switchIcon,\n          scale: 0.09,\n        }),\n      }),\n    });\n\n    //layers with network equipment\n\n    //map feature settings\n\n    //layers settings\n    map.addLayer(this.clientStationsLayer);\n    map.addLayer(this.switchesLayer);\n    map.addLayer(this.opticsLayer);\n    //layers settings\n    //click on map\n    map.on(\n      \"click\",\n      function (pointOfClick) {\n        const clickedCoordinate = transform(\n          pointOfClick.coordinate,\n          \"EPSG:3857\",\n          \"EPSG:4326\"\n        );\n\n        let coordinateString =\n          clickedCoordinate[0].toFixed(6) +\n          \",\" +\n          clickedCoordinate[1].toFixed(6);\n        this.setState({\n          coordinates: coordinateString,\n          featureCoordinates: coordinateString,\n        });\n\n        map.forEachFeatureAtPixel(\n          pointOfClick.pixel,\n          function (feature) {\n            this.setState({\n              featureInfo: {\n                featureCoordinates: feature.getProperties().featureCoordinates,\n                address: feature.getProperties().address,\n                ipAddress: feature.getProperties().ipAddress,\n                info: feature.getProperties().info,\n                locationInfo: feature.getProperties().locationInfo,\n                featureContainerArray: feature.getProperties()\n                  .featureContainerArray,\n              },\n            });\n            this.state.map\n              .getView()\n              .animate({ center: fromLonLat(clickedCoordinate) }, { zoom: 19 });\n          }.bind(this)\n        );\n      }.bind(this)\n    );\n\n    // change features size on zoom change\n    map.getView().on(\"propertychange\", (e) => {\n      // switch (e.key) {\n      //   case \"resolution\":\n      //     this.handleZoom(map.getView().getZoom());\n      //     break;\n      // }\n      if (e.key === \"resolution\") {\n        this.handleZoom(map.getView().getZoom());\n      }\n    });\n\n    this.setState({\n      map: map,\n    });\n  }\n\n  componentDidMount() {\n    this.initMapComponent();\n  }\n\n  setSwitchesToRightControlPanel() {\n    this.setState({\n      displayedFeatures: this.state.switchesContainerArray,\n    });\n  }\n  setOpticsToRightControlPanel() {\n    this.setState({\n      displayedFeatures: this.state.opticsContainerArray,\n    });\n  }\n  setClientStationsToRightControlPanel() {\n    this.setState({\n      displayedFeatures: this.state.clientStationsContainerArray,\n    });\n  }\n\n  handleRightPanelItemClick(item) {\n    if (this.state.currentForm != null) {\n      this.setState({\n        currentForm: null,\n        formItemType: null,\n      });\n    }\n\n    let coordinatesForAnimation;\n    let featureCoordinates = item.getProperties().featureCoordinates;\n\n    if (Array.isArray(featureCoordinates[0])) {\n      coordinatesForAnimation = featureCoordinates[0];\n    } else {\n      coordinatesForAnimation = featureCoordinates;\n    }\n\n    this.state.map.getView().animate(\n      {\n        center: fromLonLat(coordinatesForAnimation),\n      },\n      { zoom: 18.5 }\n    );\n\n    this.setState({\n      featureInfo: {\n        featureCoordinates: item.getProperties().featureCoordinates,\n        address: item.getProperties().address,\n        ipAddress: item.getProperties().ipAddress,\n        info: item.getProperties().info,\n        locationInfo: item.getProperties().locationInfo,\n      },\n    });\n  }\n\n  changeFeaturesSize(strokeWidth, iconsScale) {\n    this.switchesLayer.setStyle(\n      new Style({\n        image: new Icon({\n          opacity: 1,\n          src: switchIcon,\n          scale: iconsScale,\n        }),\n      })\n    );\n    this.opticsLayer.setStyle(\n      new Style({\n        stroke: new Stroke({\n          width: strokeWidth,\n          color: \"skyblue\",\n        }),\n      })\n    );\n    this.clientStationsLayer.setStyle(\n      new Style({\n        image: new Icon({\n          opacity: 1,\n          src: clientStationIcon,\n          scale: iconsScale,\n        }),\n      })\n    );\n  }\n\n  handleZoom(zoomSize) {\n    if (zoomSize < 12) {\n      this.changeFeaturesSize(0.5, 0.01);\n    } else if (zoomSize < 13) {\n      this.changeFeaturesSize(2, 0.05);\n    } else if (zoomSize < 14) {\n      this.changeFeaturesSize(2, 0.08);\n    } else if (zoomSize < 16) {\n      this.changeFeaturesSize(2, 0.1);\n    } else if (zoomSize < 18) {\n      this.changeFeaturesSize(4, 0.12);\n    } else {\n      this.changeFeaturesSize(7, 0.25);\n    }\n  }\n\n  getFeatureInfo(featureInfo) {\n    return featureInfo !== null ? (\n      <div className=\"featureInfoElement\">{featureInfo}</div>\n    ) : (\n      <div className=\"hidden\"></div>\n    );\n  }\n  getfeatureInfoBlock() {\n    if (this.state.featureInfo.featureCoordinates !== null) {\n      return (\n        <div className=\"featureInfo\">\n          {this.getFeatureInfo(this.state.featureInfo.address)}\n          {this.getFeatureInfo(this.state.featureInfo.ipAddress)}\n          {this.getFeatureInfo(this.state.featureInfo.info)}\n          {this.getFeatureInfo(this.state.featureInfo.locationInfo)}\n          <div\n            className=\"editButton\"\n            onClick={() => {\n              this.setState({\n                currentForm: null,\n              });\n              this.setState({\n                currentForm: \"edit\",\n              });\n            }}\n          >\n            Edit\n          </div>\n        </div>\n      );\n    } else {\n      return <div className=\"hidden\"></div>;\n    }\n  }\n\n  handleEditSubmit = (evt) => {\n    evt.preventDefault();\n    let editedItem = {\n      address: this.refs.addressFormField.value,\n      locationInfo: this.refs.locationInfoFormField.value,\n      ipAddress: this.refs.ipAddressFormField.value,\n      info: this.refs.infoFormField.value,\n      coordinates: this.refs.coordinateFormField.value.split(\",\"),\n    };\n    let itemToEdit = {\n      address: this.state.featureInfo.address,\n      locationInfo: this.state.featureInfo.locationInfo,\n      ipAddress: this.state.featureInfo.ipAddress,\n      info: this.state.featureInfo.info,\n      coordinates: this.state.featureInfo.featureCoordinates,\n    };\n\n    this.setState({\n      currentForm: null,\n    });\n    function transformCoordinates(coordinates) {\n      let opticsCoordinates = [];\n      // let formCoordinatesArray = coordinates.split(\",\");\n      let arrayLenght = coordinates.length;\n\n      let i = 0;\n      while (i < arrayLenght) {\n        opticsCoordinates.push(new Array(coordinates[i], coordinates[i + 1]));\n        i++;\n        i++;\n      }\n      return opticsCoordinates;\n    }\n    if (\n      !Array.isArray(editedItem.coordinates[0]) &&\n      !Array.isArray(itemToEdit.coordinates[0])\n    ) {\n      this.editSwitchInfo(itemToEdit, editedItem);\n      this.editClientStationInfo(itemToEdit, editedItem);\n    } else {\n      this.editOptics(\n        {\n          address: this.state.featureInfo.address,\n          locationInfo: this.state.featureInfo.locationInfo,\n          ipAddress: this.state.featureInfo.ipAddress,\n          info: this.state.featureInfo.info,\n          coordinates: transformCoordinates(\n            this.state.featureInfo.featureCoordinates\n          ),\n        },\n        {\n          address: this.refs.addressFormField.value,\n          locationInfo: this.refs.locationInfoFormField.value,\n          ipAddress: this.refs.ipAddressFormField.value,\n          info: this.refs.infoFormField.value,\n          coordinates: transformCoordinates(\n            this.refs.coordinateFormField.value.split(\",\")\n          ),\n        }\n      );\n    }\n    this.setState({\n      displayedFeatures: null,\n      featureInfo: {\n        featureCoordinates: null,\n        address: null,\n        ipAddress: null,\n        info: null,\n        locationInfo: null,\n      },\n    });\n  };\n\n  handleDeleteButton = (evt) => {\n    evt.preventDefault();\n    let itemToDelete = {\n      address: this.refs.addressFormField.value,\n      locationInfo: this.refs.locationInfoFormField.value,\n      ipAddress: this.refs.ipAddressFormField.value,\n      info: this.refs.infoFormField.value,\n      coordinates: this.refs.coordinateFormField.value.split(\",\"),\n    };\n\n    let opticsCoordinates = [];\n    let formCoordinatesArray = this.refs.coordinateFormField.value.split(\",\");\n    let arrayLenght = formCoordinatesArray.length;\n\n    let i = 0;\n    while (i < arrayLenght) {\n      opticsCoordinates.push(\n        new Array(formCoordinatesArray[i], formCoordinatesArray[i + 1])\n      );\n      i++;\n      i++;\n    }\n    this.deleteSwitch(itemToDelete);\n    this.deleteClientStation(itemToDelete);\n    this.deleteOptics({\n      address: this.refs.addressFormField.value,\n      locationInfo: this.refs.locationInfoFormField.value,\n      ipAddress: this.refs.ipAddressFormField.value,\n      info: this.refs.infoFormField.value,\n      coordinates: opticsCoordinates,\n    });\n    this.setState({\n      displayedFeatures: null,\n      featureInfo: {\n        featureCoordinates: null,\n        address: null,\n        ipAddress: null,\n        info: null,\n        locationInfo: null,\n      },\n    });\n  };\n\n  handleAddSubmit = (evt) => {\n    evt.preventDefault();\n\n    let itemType = this.state.formItemType;\n\n    switch (itemType) {\n      case \"switch\":\n        let switchCoordinatesFromForm = this.refs.coordinateFormField.value.split(\n          \",\"\n        );\n        if (!Array.isArray(switchCoordinatesFromForm[0])) {\n          this.addNewSwitch({\n            address: this.refs.addressFormField.value,\n            locationInfo: this.refs.locationInfoFormField.value,\n            ipAddress: this.refs.ipAddressFormField.value,\n            info: this.refs.infoFormField.value,\n            coordinates: this.refs.coordinateFormField.value.split(\",\"),\n          });\n        } else {\n          console.log(\"Wrong coordinates for switch.\");\n        }\n\n        break;\n      case \"clientStation\":\n        let clientStationCoordinatesFromForm = this.refs.coordinateFormField.value.split(\n          \",\"\n        );\n        if (!Array.isArray(clientStationCoordinatesFromForm[0])) {\n          this.addNewClientStation({\n            address: this.refs.addressFormField.value,\n            locationInfo: this.refs.locationInfoFormField.value,\n            ipAddress: this.refs.ipAddressFormField.value,\n            info: this.refs.infoFormField.value,\n            coordinates: this.refs.coordinateFormField.value.split(\",\"),\n          });\n        } else {\n          console.log(\"Wrong coordinates for client station.\");\n        }\n        break;\n      case \"opticCable\":\n        let opticsCoordinates = [];\n        let formCoordinatesArray = this.refs.coordinateFormField.value.split(\n          \",\"\n        );\n        let arrayLenght = formCoordinatesArray.length;\n        if (arrayLenght % 2 !== 0 || arrayLenght === 0) {\n          console.log(\"Wrong optics coordinates.\");\n        } else {\n          if (arrayLenght <= 2) {\n            console.log(\"need more points.\");\n          } else {\n            let i = 0;\n            while (i < arrayLenght) {\n              opticsCoordinates.push(\n                new Array(formCoordinatesArray[i], formCoordinatesArray[i + 1])\n              );\n              i++;\n              i++;\n            }\n            this.addOptics({\n              address: this.refs.addressFormField.value,\n              locationInfo: this.refs.locationInfoFormField.value,\n              ipAddress: this.refs.ipAddressFormField.value,\n              info: this.refs.infoFormField.value,\n              coordinates: opticsCoordinates,\n            });\n          }\n        }\n\n        break;\n      default:\n        console.log(\"Default case\");\n    }\n\n    this.setState({\n      currentForm: null,\n    });\n  };\n\n  handleAddButton(itemType) {\n    this.setState({ formItemType: itemType });\n  }\n\n  getEditingOrAddingForm(itemType) {\n    if (this.state.currentForm === \"add\") {\n      return (\n        <div className=\"formContainer\">\n          <form\n            className=\"addForm\"\n            onSubmit={(evt) => this.handleAddSubmit(evt, itemType)}\n          >\n            <textarea\n              className=\"formField\"\n              ref=\"coordinateFormField\"\n              placeholder=\"coordinates\"\n              defaultValue={this.state.featureCoordinates}\n            ></textarea>\n            <textarea\n              className=\"formField\"\n              ref=\"addressFormField\"\n              placeholder=\"address\"\n              defaultValue=\"\"\n            ></textarea>\n            <textarea\n              className=\"formField\"\n              ref=\"ipAddressFormField\"\n              placeholder=\"ip address\"\n              defaultValue=\"\"\n            ></textarea>\n            <textarea\n              className=\"formField\"\n              ref=\"locationInfoFormField\"\n              placeholder=\"location info\"\n              defaultValue=\"\"\n            ></textarea>\n            <textarea\n              className=\"formField\"\n              ref=\"infoFormField\"\n              placeholder=\"additional info\"\n              defaultValue=\"\"\n            ></textarea>\n            <div className=\"formButtonsContainer\">\n              <button type=\"submit\">Submit</button>\n              <button\n                type=\"button\"\n                onClick={() => this.setState({ currentForm: null })}\n              >\n                Cancel\n              </button>\n            </div>\n          </form>\n        </div>\n      );\n    } else if (this.state.currentForm === \"edit\") {\n      return (\n        <div className=\"formContainer\">\n          <form\n            className=\"editForm\"\n            onSubmit={(evt) => this.handleEditSubmit(evt)}\n          >\n            <textarea\n              className=\"formField\"\n              ref=\"coordinateFormField\"\n              defaultValue={this.state.featureInfo.featureCoordinates}\n              style={{ backgroundColor: \"lightgray\" }}\n              readOnly\n            ></textarea>\n            <textarea\n              className=\"formField\"\n              ref=\"addressFormField\"\n              placeholder=\"address\"\n              defaultValue={this.state.featureInfo.address}\n            ></textarea>\n            <textarea\n              className=\"formField\"\n              ref=\"ipAddressFormField\"\n              placeholder=\"ip address\"\n              defaultValue={this.state.featureInfo.ipAddress}\n            ></textarea>\n            <textarea\n              className=\"formField\"\n              ref=\"locationInfoFormField\"\n              placeholder=\"location info\"\n              defaultValue={this.state.featureInfo.locationInfo}\n            ></textarea>\n            <textarea\n              className=\"formField\"\n              ref=\"infoFormField\"\n              placeholder=\"additional info\"\n              defaultValue={this.state.featureInfo.info}\n            ></textarea>\n            <div className=\"formButtonsContainer\">\n              <button\n                type=\"button\"\n                onClick={(evt) => {\n                  this.handleDeleteButton(evt);\n                  this.setState({\n                    currentForm: null,\n                  });\n                }}\n              >\n                Delete\n              </button>\n              <button type=\"submit\">Submit</button>\n              <button\n                type=\"button\"\n                onClick={() => this.setState({ currentForm: null })}\n              >\n                Cancel\n              </button>\n            </div>\n          </form>\n        </div>\n      );\n    } else {\n      return <div></div>;\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"opticMapComponent\">\n        <div className=\"leftMapPanel\">\n          <div className=\"coordinateString\" id=\"coordinateString\">\n            {this.state.coordinates}\n          </div>\n\n          <div className=\"objectButtons\">\n            <div className=\"featureInfoAddControls\">\n              <div\n                className=\"objectButton\"\n                onClick={this.setSwitchesToRightControlPanel}\n              >\n                switches\n              </div>\n              <div\n                className=\"addFeatureButton\"\n                onClick={() => {\n                  this.setState({ currentForm: null });\n                  this.handleAddButton(\"switch\");\n                  this.setState({ currentForm: \"add\" });\n                }}\n              >\n                add\n              </div>\n            </div>\n            <div className=\"featureInfoAddControls\">\n              <div\n                className=\"objectButton\"\n                onClick={this.setOpticsToRightControlPanel}\n              >\n                optic cable\n              </div>\n              <div\n                className=\"addFeatureButton\"\n                onClick={() => {\n                  this.setState({ currentForm: null });\n                  this.handleAddButton(\"opticCable\");\n                  this.setState({ currentForm: \"add\" });\n                }}\n              >\n                add\n              </div>\n            </div>\n            <div className=\"featureInfoAddControls\">\n              <div\n                className=\"objectButton\"\n                onClick={this.setClientStationsToRightControlPanel}\n              >\n                client stations\n              </div>\n              <div\n                className=\"addFeatureButton\"\n                onClick={() => {\n                  this.setState({ currentForm: null });\n                  this.handleAddButton(\"clientStation\");\n                  this.setState({ currentForm: \"add\" });\n                }}\n              >\n                add\n              </div>\n            </div>\n          </div>\n          {this.getfeatureInfoBlock()}\n          {this.getEditingOrAddingForm(\n            this.state.featureInfo.featureCoordinates,\n            this.state.featureInfo.address,\n            this.state.featureInfo.ipAddress,\n            this.state.featureInfo.locationInfo,\n            this.state.featureInfo.info\n          )}\n        </div>\n        <div className=\"mapContainer\" ref=\"mapContainer\"></div>\n        <div className=\"rightMapPanel\">\n          <div className=\"displayedFeatures\">\n            {this.state.displayedFeatures !== null ? (\n              this.state.displayedFeatures.map((feature) => {\n                return (\n                  <li\n                    className=\"displayedFeature\"\n                    key={feature.getProperties().featureCoordinates}\n                    onClick={this.handleRightPanelItemClick.bind(this, feature)}\n                  >\n                    {feature.getProperties().address}\n                  </li>\n                );\n              })\n            ) : (\n              <div></div>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default OpticMap;\n"]},"metadata":{},"sourceType":"module"}